import{_ as i,c as a,o as l,ag as e}from"./chunks/framework.DPDPlp3K.js";const E=JSON.parse('{"title":"钱包与签名","description":"","frontmatter":{},"headers":[],"relativePath":"web3/wallet.md","filePath":"web3/wallet.md","lastUpdated":1747111449000}'),n={name:"web3/wallet.md"};function t(h,s,r,p,k,d){return l(),a("div",null,s[0]||(s[0]=[e(`<h1 id="钱包与签名" tabindex="-1">钱包与签名 <a class="header-anchor" href="#钱包与签名" aria-label="Permalink to &quot;钱包与签名&quot;">​</a></h1><h2 id="_1-钱包基本原理与类型" tabindex="-1">1. 钱包基本原理与类型 <a class="header-anchor" href="#_1-钱包基本原理与类型" aria-label="Permalink to &quot;1. 钱包基本原理与类型&quot;">​</a></h2><p>区块链钱包用于管理用户的私钥、公钥和地址，是用户与区块链交互的核心工具。</p><h3 id="_1-1-钱包类型" tabindex="-1">1.1 钱包类型 <a class="header-anchor" href="#_1-1-钱包类型" aria-label="Permalink to &quot;1.1 钱包类型&quot;">​</a></h3><ul><li><strong>热钱包</strong>（软件钱包）：如 MetaMask、imToken，便于日常使用，安全性依赖设备环境</li><li><strong>冷钱包</strong>（硬件钱包）：如 Ledger、Trezor，私钥离线存储，适合大额资产</li><li><strong>多签钱包</strong>：如 Gnosis Safe，多方共同签名，提升安全性</li><li><strong>智能合约钱包</strong>：支持账户抽象、社交恢复、批量操作等高级功能</li></ul><h3 id="_1-2-钱包核心原理" tabindex="-1">1.2 钱包核心原理 <a class="header-anchor" href="#_1-2-钱包核心原理" aria-label="Permalink to &quot;1.2 钱包核心原理&quot;">​</a></h3><ul><li>助记词（Mnemonic）：BIP39 标准，12/24 个英文单词</li><li>私钥（Private Key）：控制资产的唯一凭证</li><li>公钥（Public Key）：由私钥推导，用于生成地址</li><li>地址（Address）：区块链账户标识</li><li>Keystore：加密存储私钥的 JSON 文件，需密码解锁</li></ul><h2 id="_2-助记词-私钥-keystore-标准与操作" tabindex="-1">2. 助记词/私钥/Keystore 标准与操作 <a class="header-anchor" href="#_2-助记词-私钥-keystore-标准与操作" aria-label="Permalink to &quot;2. 助记词/私钥/Keystore 标准与操作&quot;">​</a></h2><h3 id="_2-1-助记词生成与导入" tabindex="-1">2.1 助记词生成与导入 <a class="header-anchor" href="#_2-1-助记词生成与导入" aria-label="Permalink to &quot;2.1 助记词生成与导入&quot;">​</a></h3><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * 生成助记词</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@returns</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> {string}</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 助记词</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { ethers } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;ethers&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mnemonic</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ethers.Wallet.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createRandom</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().mnemonic.phrase;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;助记词:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, mnemonic);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_2-2-私钥与-keystore-导入导出" tabindex="-1">2.2 私钥与 Keystore 导入导出 <a class="header-anchor" href="#_2-2-私钥与-keystore-导入导出" aria-label="Permalink to &quot;2.2 私钥与 Keystore 导入导出&quot;">​</a></h3><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 私钥导入</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> wallet</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ethers.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Wallet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(privateKey);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Keystore 导出</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wallet.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">encrypt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(password).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">json</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(json));</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Keystore 导入</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ethers.Wallet.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fromEncryptedJson</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(json, password).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(console.log);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="_2-3-助记词-私钥兼容性" tabindex="-1">2.3 助记词/私钥兼容性 <a class="header-anchor" href="#_2-3-助记词-私钥兼容性" aria-label="Permalink to &quot;2.3 助记词/私钥兼容性&quot;">​</a></h3><ul><li>建议遵循 BIP39（助记词）、BIP44（路径）、BIP32（分层确定性钱包）标准</li><li>助记词/私钥可跨钱包导入，注意路径一致性</li></ul><h2 id="_3-多签钱包与硬件钱包" tabindex="-1">3. 多签钱包与硬件钱包 <a class="header-anchor" href="#_3-多签钱包与硬件钱包" aria-label="Permalink to &quot;3. 多签钱包与硬件钱包&quot;">​</a></h2><h3 id="_3-1-多签钱包原理与代码-gnosis-safe" tabindex="-1">3.1 多签钱包原理与代码（Gnosis Safe） <a class="header-anchor" href="#_3-1-多签钱包原理与代码-gnosis-safe" aria-label="Permalink to &quot;3.1 多签钱包原理与代码（Gnosis Safe）&quot;">​</a></h3><ul><li>多签钱包需多方签名才能转账，提高安全性</li><li>推荐使用 Gnosis Safe</li><li>典型应用：DAO 金库、企业资金管理</li></ul><h3 id="_3-2-硬件钱包" tabindex="-1">3.2 硬件钱包 <a class="header-anchor" href="#_3-2-硬件钱包" aria-label="Permalink to &quot;3.2 硬件钱包&quot;">​</a></h3><ul><li>私钥存储于硬件芯片，操作需物理确认</li><li>支持主流链与多种钱包软件集成</li><li>适合长期大额资产存储</li></ul><h2 id="_4-钱包签名机制与-eip-712" tabindex="-1">4. 钱包签名机制与 EIP-712 <a class="header-anchor" href="#_4-钱包签名机制与-eip-712" aria-label="Permalink to &quot;4. 钱包签名机制与 EIP-712&quot;">​</a></h2><h3 id="_4-1-签名机制" tabindex="-1">4.1 签名机制 <a class="header-anchor" href="#_4-1-签名机制" aria-label="Permalink to &quot;4.1 签名机制&quot;">​</a></h3><ul><li>私钥签名，公钥验证</li><li>支持消息签名、交易签名、结构化数据签名</li></ul><h3 id="_4-2-eip-712-结构化数据签名" tabindex="-1">4.2 EIP-712 结构化数据签名 <a class="header-anchor" href="#_4-2-eip-712-结构化数据签名" aria-label="Permalink to &quot;4.2 EIP-712 结构化数据签名&quot;">​</a></h3><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * EIP-712 签名</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> domain</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;DApp&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, version: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, chainId: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, verifyingContract: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;0x...&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> };</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> types</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { Mail: [ { name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;from&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, type: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;address&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }, { name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;to&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, type: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;address&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }, { name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;contents&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, type: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;string&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } ] };</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { from: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;0x...&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, to: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;0x...&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, contents: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hello&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> };</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> signature</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> signer.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_signTypedData</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(domain, types, value);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>EIP-712 可防止签名钓鱼，提升安全性</li></ul><h2 id="_5-钱包与-dapp-交互流程" tabindex="-1">5. 钱包与 DApp 交互流程 <a class="header-anchor" href="#_5-钱包与-dapp-交互流程" aria-label="Permalink to &quot;5. 钱包与 DApp 交互流程&quot;">​</a></h2><ol><li>用户在 DApp 前端点击&quot;连接钱包&quot;按钮</li><li>前端调用 <code>window.ethereum.request({ method: &#39;eth_requestAccounts&#39; })</code></li><li>用户在钱包中确认</li><li>DApp 获取用户地址并可发起链上操作</li><li>用户签名或发起交易，DApp 监听回执</li></ol><h2 id="_6-钱包常见安全攻击与防护" tabindex="-1">6. 钱包常见安全攻击与防护 <a class="header-anchor" href="#_6-钱包常见安全攻击与防护" aria-label="Permalink to &quot;6. 钱包常见安全攻击与防护&quot;">​</a></h2><ul><li>钓鱼网站：只在官网或可信链接下载钱包</li><li>恶意 DApp：仔细核查授权内容</li><li>助记词/私钥泄露：永不在不可信环境输入助记词</li><li>恶意插件/病毒：定期查杀，避免安装未知插件</li><li>建议：使用硬件钱包、开启多签、定期更换密码、分层管理资产</li></ul><h2 id="_7-钱包开发与集成最佳实践" tabindex="-1">7. 钱包开发与集成最佳实践 <a class="header-anchor" href="#_7-钱包开发与集成最佳实践" aria-label="Permalink to &quot;7. 钱包开发与集成最佳实践&quot;">​</a></h2><ul><li>遵循 BIP39/BIP44/BIP32 标准，提升兼容性</li><li>前端集成推荐使用 ethers.js、web3.js</li><li>钱包连接建议用 WalletConnect、RainbowKit</li><li>支持 EIP-1193 钱包标准接口，兼容多钱包</li><li>重要操作需二次确认，敏感信息不落地</li><li>钱包 UI 需提示风险、授权范围、签名内容</li></ul><h2 id="_8-账户抽象与智能钱包" tabindex="-1">8. 账户抽象与智能钱包 <a class="header-anchor" href="#_8-账户抽象与智能钱包" aria-label="Permalink to &quot;8. 账户抽象与智能钱包&quot;">​</a></h2><ul><li>账户抽象（Account Abstraction，AA）：如 ERC-4337，支持合约钱包、批量操作、Gas 代付、社交恢复等</li><li>智能钱包：如 Safe、Argent，支持权限管理、自动化操作</li><li>未来趋势：提升安全性与用户体验，降低私钥丢失风险</li></ul><h2 id="_9-钱包常见问题与解答-faq" tabindex="-1">9. 钱包常见问题与解答（FAQ） <a class="header-anchor" href="#_9-钱包常见问题与解答-faq" aria-label="Permalink to &quot;9. 钱包常见问题与解答（FAQ）&quot;">​</a></h2><ul><li>助记词/私钥格式不兼容：建议使用 BIP39/BIP44 标准</li><li>钱包与 DApp 连接失败：检查网络、MetaMask 状态、浏览器兼容性</li><li>签名不一致：注意消息格式、编码方式、链ID</li><li>Keystore 解密失败：确认密码、文件完整性</li><li>钱包余额不显示：检查网络、节点同步状态</li></ul><h2 id="_10-术语表与缩略语" tabindex="-1">10. 术语表与缩略语 <a class="header-anchor" href="#_10-术语表与缩略语" aria-label="Permalink to &quot;10. 术语表与缩略语&quot;">​</a></h2><table tabindex="0"><thead><tr><th>术语</th><th>解释</th></tr></thead><tbody><tr><td>助记词</td><td>记忆型私钥备份，BIP39 标准</td></tr><tr><td>Keystore</td><td>加密私钥文件，需密码解锁</td></tr><tr><td>BIP39/BIP44</td><td>助记词/路径标准</td></tr><tr><td>EIP-712</td><td>结构化数据签名标准</td></tr><tr><td>EIP-1193</td><td>钱包与 DApp 通用接口标准</td></tr><tr><td>多签</td><td>多重签名钱包</td></tr><tr><td>账户抽象</td><td>Account Abstraction，智能钱包新范式</td></tr><tr><td>AA</td><td>账户抽象缩写</td></tr><tr><td>硬件钱包</td><td>离线存储私钥的物理设备</td></tr><tr><td>热钱包</td><td>在线软件钱包</td></tr><tr><td>冷钱包</td><td>离线硬件钱包</td></tr></tbody></table><h2 id="_11-参考资料与延伸阅读" tabindex="-1">11. 参考资料与延伸阅读 <a class="header-anchor" href="#_11-参考资料与延伸阅读" aria-label="Permalink to &quot;11. 参考资料与延伸阅读&quot;">​</a></h2><ul><li><a href="https://docs.metamask.io/" target="_blank" rel="noreferrer">MetaMask 官方文档</a></li><li><a href="https://docs.ethers.org/v5/api/signer/" target="_blank" rel="noreferrer">Ethers.js 钱包文档</a></li><li><a href="https://safe.global/" target="_blank" rel="noreferrer">Gnosis Safe</a></li><li><a href="https://www.ledger.com/academy" target="_blank" rel="noreferrer">Ledger 官方文档</a></li><li><a href="https://eips.ethereum.org/EIPS/eip-712" target="_blank" rel="noreferrer">EIP-712 说明</a></li><li><a href="https://eips.ethereum.org/EIPS/eip-4337" target="_blank" rel="noreferrer">EIP-4337 账户抽象</a></li></ul><hr><p>后续将介绍 DApp 开发与常用工具。</p>`,41)]))}const c=i(n,[["render",t]]);export{E as __pageData,c as default};
