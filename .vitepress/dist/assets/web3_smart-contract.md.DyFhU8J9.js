import{_ as i,c as a,o as n,ag as l}from"./chunks/framework.DPDPlp3K.js";const o=JSON.parse('{"title":"智能合约","description":"","frontmatter":{},"headers":[],"relativePath":"web3/smart-contract.md","filePath":"web3/smart-contract.md","lastUpdated":1747111449000}'),e={name:"web3/smart-contract.md"};function t(h,s,p,k,r,d){return n(),a("div",null,s[0]||(s[0]=[l(`<h1 id="智能合约" tabindex="-1">智能合约 <a class="header-anchor" href="#智能合约" aria-label="Permalink to &quot;智能合约&quot;">​</a></h1><h2 id="_1-智能合约定义与原理" tabindex="-1">1. 智能合约定义与原理 <a class="header-anchor" href="#_1-智能合约定义与原理" aria-label="Permalink to &quot;1. 智能合约定义与原理&quot;">​</a></h2><p>智能合约（Smart Contract）是一种自动执行、不可篡改的区块链程序，能在无需第三方的情况下自动完成合约条款。其核心特性包括：</p><ul><li>自动执行：合约逻辑一旦部署，按规则自动运行</li><li>不可篡改：链上代码和数据不可随意更改</li><li>公开透明：所有人可查阅合约代码和历史操作</li></ul><h2 id="_2-智能合约开发语言" tabindex="-1">2. 智能合约开发语言 <a class="header-anchor" href="#_2-智能合约开发语言" aria-label="Permalink to &quot;2. 智能合约开发语言&quot;">​</a></h2><ul><li><strong>Solidity</strong>：以太坊主流开发语言，语法类似 JavaScript</li><li><strong>Vyper</strong>：安全性更高，语法类似 Python</li><li><strong>Move/Rust</strong>：适用于 Aptos、Sui、Solana 等新公链</li></ul><h2 id="_3-智能合约生命周期" tabindex="-1">3. 智能合约生命周期 <a class="header-anchor" href="#_3-智能合约生命周期" aria-label="Permalink to &quot;3. 智能合约生命周期&quot;">​</a></h2><ol><li>编写：使用 Solidity/Vyper 等语言开发</li><li>编译：生成字节码和 ABI</li><li>部署：通过钱包或脚本部署到链上</li><li>调用：用户或合约与其交互</li><li>升级：通过代理模式等实现逻辑升级</li><li>销毁：可选，部分合约支持自毁</li></ol><h2 id="_4-典型合约代码示例" tabindex="-1">4. 典型合约代码示例 <a class="header-anchor" href="#_4-典型合约代码示例" aria-label="Permalink to &quot;4. 典型合约代码示例&quot;">​</a></h2><h3 id="_4-1-helloworld-合约" tabindex="-1">4.1 HelloWorld 合约 <a class="header-anchor" href="#_4-1-helloworld-合约" aria-label="Permalink to &quot;4.1 HelloWorld 合约&quot;">​</a></h3><div class="language-solidity vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">solidity</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// SPDX-License-Identifier: MIT</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">pragma</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;"> solidity</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ^0.8.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@title</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> HelloWorld</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@dev</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 简单的智能合约示例</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">contract</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HelloWorld</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    string</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> greet </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Hello, Web3!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@notice</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 设置问候语</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _greet</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 新的问候语</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> setGreet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">string</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> memory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _greet) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        greet </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _greet;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="_4-2-erc20-代币合约" tabindex="-1">4.2 ERC20 代币合约 <a class="header-anchor" href="#_4-2-erc20-代币合约" aria-label="Permalink to &quot;4.2 ERC20 代币合约&quot;">​</a></h3><div class="language-solidity vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">solidity</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// SPDX-License-Identifier: MIT</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">pragma</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;"> solidity</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ^0.8.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@openzeppelin/contracts/token/ERC20/ERC20.sol&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@title</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> MyToken</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@dev</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 简单的ERC20代币</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">contract</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MyToken</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> is</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ERC20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ERC20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(&quot;MyToken&quot;, &quot;MTK&quot;) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        _mint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">msg.sender</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000000</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> **</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> decimals</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="_4-3-投票合约" tabindex="-1">4.3 投票合约 <a class="header-anchor" href="#_4-3-投票合约" aria-label="Permalink to &quot;4.3 投票合约&quot;">​</a></h3><div class="language-solidity vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">solidity</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// SPDX-License-Identifier: MIT</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">pragma</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;"> solidity</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ^0.8.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">contract</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Ballot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    struct</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Voter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> voted;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        uint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> vote;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    mapping</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">address</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Voter) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> voters;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> proposals;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    uint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> votes;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">memory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _proposals) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        proposals </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _proposals;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        votes </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> uint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[](_proposals.</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> vote</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">uint</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> proposal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">voters[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">msg.sender</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].voted, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;已投票&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        voters[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">msg.sender</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].voted </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        voters[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">msg.sender</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].vote </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> proposal;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        votes[proposal]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="_4-4-nft-erc721-合约" tabindex="-1">4.4 NFT（ERC721）合约 <a class="header-anchor" href="#_4-4-nft-erc721-合约" aria-label="Permalink to &quot;4.4 NFT（ERC721）合约&quot;">​</a></h3><div class="language-solidity vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">solidity</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// SPDX-License-Identifier: MIT</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">pragma</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;"> solidity</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ^0.8.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@openzeppelin/contracts/token/ERC721/ERC721.sol&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">contract</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MyNFT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> is</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ERC721</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ERC721</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(&quot;MyNFT&quot;, &quot;MNFT&quot;) {}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> mint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">address</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> to</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">uint256</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> tokenId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        _mint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(to, tokenId);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="_5-智能合约标准" tabindex="-1">5. 智能合约标准 <a class="header-anchor" href="#_5-智能合约标准" aria-label="Permalink to &quot;5. 智能合约标准&quot;">​</a></h2><ul><li><strong>ERC20</strong>：同质化代币标准</li><li><strong>ERC721</strong>：非同质化代币（NFT）标准</li><li><strong>ERC1155</strong>：多代币标准</li><li><strong>EIP-相关</strong>：如 EIP-2612、EIP-712 等</li></ul><h2 id="_6-合约部署与调用" tabindex="-1">6. 合约部署与调用 <a class="header-anchor" href="#_6-合约部署与调用" aria-label="Permalink to &quot;6. 合约部署与调用&quot;">​</a></h2><h3 id="_6-1-使用-hardhat-部署" tabindex="-1">6.1 使用 Hardhat 部署 <a class="header-anchor" href="#_6-1-使用-hardhat-部署" aria-label="Permalink to &quot;6.1 使用 Hardhat 部署&quot;">​</a></h3><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * 部署 HelloWorld 合约</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@returns</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> {Promise&lt;void&gt;}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> hre</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;hardhat&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> HelloWorld</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> hre.ethers.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getContractFactory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;HelloWorld&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> hello</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> HelloWorld.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">deploy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> hello.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">deployed</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;合约地址:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, hello.address);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="_6-2-前端集成-ethers-js-web3-js" tabindex="-1">6.2 前端集成（ethers.js/web3.js） <a class="header-anchor" href="#_6-2-前端集成-ethers-js-web3-js" aria-label="Permalink to &quot;6.2 前端集成（ethers.js/web3.js）&quot;">​</a></h3><ul><li>合约 ABI 解析</li><li>合约方法调用、事件监听</li><li>钱包连接与签名</li></ul><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { ethers } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;ethers&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> abi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* 合约ABI */</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> contract</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ethers.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Contract</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(address, abi, provider);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> contract.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">greet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="_7-事件与日志监听" tabindex="-1">7. 事件与日志监听 <a class="header-anchor" href="#_7-事件与日志监听" aria-label="Permalink to &quot;7. 事件与日志监听&quot;">​</a></h2><ul><li>合约事件定义与触发</li><li>前端监听与响应</li><li>事件数据解析</li></ul><div class="language-solidity vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">solidity</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 合约中定义事件</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> event</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GreetChanged</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">string</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> newGreet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> setGreet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">string</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> memory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _greet) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   greet </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _greet;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   emit</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GreetChanged</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(_greet);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 前端监听事件</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hello.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;GreetChanged&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">newGreet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;新问候语:&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, newGreet);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="_8-合约单元测试与覆盖率" tabindex="-1">8. 合约单元测试与覆盖率 <a class="header-anchor" href="#_8-合约单元测试与覆盖率" aria-label="Permalink to &quot;8. 合约单元测试与覆盖率&quot;">​</a></h2><ul><li>使用 Hardhat/Truffle 进行自动化测试</li><li>断言合约行为、异常处理</li><li>覆盖率工具（solidity-coverage）</li></ul><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * 测试 HelloWorld 合约</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">expect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;chai&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">describe</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;HelloWorld&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  it</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;should set and get greet&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> HelloWorld</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ethers.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getContractFactory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;HelloWorld&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> hello</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> HelloWorld.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">deploy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> hello.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setGreet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;你好&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    expect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> hello.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">greet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()).to.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">equal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;你好&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="_9-智能合约开发工具链" tabindex="-1">9. 智能合约开发工具链 <a class="header-anchor" href="#_9-智能合约开发工具链" aria-label="Permalink to &quot;9. 智能合约开发工具链&quot;">​</a></h2><h3 id="_9-1-常用开发工具" tabindex="-1">9.1 常用开发工具 <a class="header-anchor" href="#_9-1-常用开发工具" aria-label="Permalink to &quot;9.1 常用开发工具&quot;">​</a></h3><ul><li><strong>Remix IDE</strong>：在线 Solidity 开发、调试、部署环境，适合新手和快速原型开发。</li><li><strong>Hardhat</strong>：主流本地开发框架，支持 TypeScript、插件丰富，适合专业项目。</li><li><strong>Truffle</strong>：老牌开发框架，集成测试、部署、前端集成。</li><li><strong>Foundry</strong>：新兴高性能开发工具，支持 Solidity 脚本、测试、Fuzzing。</li><li><strong>OpenZeppelin Contracts</strong>：安全合约库，包含 ERC 标准、权限管理、安全工具等。</li></ul><h3 id="_9-2-工具链集成流程" tabindex="-1">9.2 工具链集成流程 <a class="header-anchor" href="#_9-2-工具链集成流程" aria-label="Permalink to &quot;9.2 工具链集成流程&quot;">​</a></h3><ol><li>使用 Hardhat/Foundry 初始化项目</li><li>编写合约，使用 OpenZeppelin 合约库</li><li>编译合约，生成 ABI 和字节码</li><li>编写测试用例，确保合约逻辑正确</li><li>使用脚本部署到测试网/主网</li><li>前端集成 ethers.js/web3.js，连接钱包与合约</li></ol><h2 id="_10-合约升级模式" tabindex="-1">10. 合约升级模式 <a class="header-anchor" href="#_10-合约升级模式" aria-label="Permalink to &quot;10. 合约升级模式&quot;">​</a></h2><ul><li>代理合约（Proxy Pattern）</li><li>UUPS、Transparent Proxy、Beacon Proxy 等模式对比</li><li>升级流程与注意事项</li><li>使用 OpenZeppelin Upgrades 插件实现合约可升级</li><li>代理合约存储数据，逻辑合约可替换</li></ul><h2 id="_11-智能合约安全开发最佳实践" tabindex="-1">11. 智能合约安全开发最佳实践 <a class="header-anchor" href="#_11-智能合约安全开发最佳实践" aria-label="Permalink to &quot;11. 智能合约安全开发最佳实践&quot;">​</a></h2><h3 id="_11-1-代码安全" tabindex="-1">11.1 代码安全 <a class="header-anchor" href="#_11-1-代码安全" aria-label="Permalink to &quot;11.1 代码安全&quot;">​</a></h3><ul><li>避免使用 tx.origin 进行权限判断</li><li>检查外部调用的重入风险</li><li>使用最新的 Solidity 版本</li><li>合理使用 require/assert/revert 处理异常</li></ul><h3 id="_11-2-审计与测试" tabindex="-1">11.2 审计与测试 <a class="header-anchor" href="#_11-2-审计与测试" aria-label="Permalink to &quot;11.2 审计与测试&quot;">​</a></h3><ul><li>使用 Slither、MythX、Oyente 等自动化审计工具</li><li>进行单元测试、集成测试、Fuzz 测试</li><li>参考 OpenZeppelin 的安全开发指南</li></ul><h3 id="_11-3-部署安全" tabindex="-1">11.3 部署安全 <a class="header-anchor" href="#_11-3-部署安全" aria-label="Permalink to &quot;11.3 部署安全&quot;">​</a></h3><ul><li>部署前多次测试，使用测试网模拟主网环境</li><li>部署后及时验证合约源码（Etherscan 等）</li><li>重要合约建议多签控制升级与治理权限</li></ul><h2 id="_12-常见安全漏洞与防护" tabindex="-1">12. 常见安全漏洞与防护 <a class="header-anchor" href="#_12-常见安全漏洞与防护" aria-label="Permalink to &quot;12. 常见安全漏洞与防护&quot;">​</a></h2><ul><li>重入攻击（Reentrancy）：使用 <code>nonReentrant</code> 修饰符</li><li>溢出/下溢：Solidity 0.8+ 内置检查</li><li>权限控制：Ownable、AccessControl</li><li>价格预言机操纵、闪电贷攻击</li><li>事件日志：记录关键操作</li><li>安全开发最佳实践（OpenZeppelin、Slither、MythX）</li></ul><h2 id="_13-合约优化与gas节省" tabindex="-1">13. 合约优化与Gas节省 <a class="header-anchor" href="#_13-合约优化与gas节省" aria-label="Permalink to &quot;13. 合约优化与Gas节省&quot;">​</a></h2><h3 id="_13-1-优化技巧" tabindex="-1">13.1 优化技巧 <a class="header-anchor" href="#_13-1-优化技巧" aria-label="Permalink to &quot;13.1 优化技巧&quot;">​</a></h3><ul><li>减少 storage 写操作</li><li>使用 calldata 代替 memory</li><li>合理拆分批量操作</li><li>事件参数精简</li></ul><h3 id="_13-2-工具辅助" tabindex="-1">13.2 工具辅助 <a class="header-anchor" href="#_13-2-工具辅助" aria-label="Permalink to &quot;13.2 工具辅助&quot;">​</a></h3><ul><li>使用 hardhat-gas-reporter 分析合约函数 Gas 消耗</li><li>参考 Etherscan Gas Tracker 了解主网实际消耗</li></ul><h2 id="_14-智能合约与链下系统交互" tabindex="-1">14. 智能合约与链下系统交互 <a class="header-anchor" href="#_14-智能合约与链下系统交互" aria-label="Permalink to &quot;14. 智能合约与链下系统交互&quot;">​</a></h2><h3 id="_14-1-预言机-oracle" tabindex="-1">14.1 预言机（Oracle） <a class="header-anchor" href="#_14-1-预言机-oracle" aria-label="Permalink to &quot;14.1 预言机（Oracle）&quot;">​</a></h3><ul><li>预言机用于将链下数据（如价格、天气）安全引入链上</li><li>主流项目：Chainlink、Band Protocol</li><li>预言机合约调用示例</li></ul><h3 id="_14-2-跨链桥" tabindex="-1">14.2 跨链桥 <a class="header-anchor" href="#_14-2-跨链桥" aria-label="Permalink to &quot;14.2 跨链桥&quot;">​</a></h3><ul><li>跨链桥合约实现资产、消息跨链转移</li><li>典型项目：Wormhole、LayerZero、Polygon Bridge</li></ul><h2 id="_15-合约治理与升级" tabindex="-1">15. 合约治理与升级 <a class="header-anchor" href="#_15-合约治理与升级" aria-label="Permalink to &quot;15. 合约治理与升级&quot;">​</a></h2><h3 id="_15-1-dao-治理集成" tabindex="-1">15.1 DAO 治理集成 <a class="header-anchor" href="#_15-1-dao-治理集成" aria-label="Permalink to &quot;15.1 DAO 治理集成&quot;">​</a></h3><ul><li>合约参数、逻辑变更由 DAO 投票决定</li><li>Timelock 延时合约保障安全</li></ul><h2 id="_16-复杂合约案例" tabindex="-1">16. 复杂合约案例 <a class="header-anchor" href="#_16-复杂合约案例" aria-label="Permalink to &quot;16. 复杂合约案例&quot;">​</a></h2><ul><li>多签钱包合约</li><li>DAO 治理合约</li><li>DeFi 协议核心合约（如 Uniswap V2/V3）</li></ul><h2 id="_17-常见应用场景" tabindex="-1">17. 常见应用场景 <a class="header-anchor" href="#_17-常见应用场景" aria-label="Permalink to &quot;17. 常见应用场景&quot;">​</a></h2><ul><li>DeFi（借贷、DEX、稳定币）</li><li>NFT（铸造、交易、拍卖）</li><li>DAO（投票、资金管理）</li><li>GameFi（资产上链、奖励分发）</li></ul><h2 id="_18-常见问题与解答-faq" tabindex="-1">18. 常见问题与解答（FAQ） <a class="header-anchor" href="#_18-常见问题与解答-faq" aria-label="Permalink to &quot;18. 常见问题与解答（FAQ）&quot;">​</a></h2><h3 id="q1-合约部署失败常见原因" tabindex="-1">Q1：合约部署失败常见原因？ <a class="header-anchor" href="#q1-合约部署失败常见原因" aria-label="Permalink to &quot;Q1：合约部署失败常见原因？&quot;">​</a></h3><ul><li>Gas 不足、构造参数错误、依赖库未部署、合约代码过大</li></ul><h3 id="q2-如何调试-solidity-合约" tabindex="-1">Q2：如何调试 Solidity 合约？ <a class="header-anchor" href="#q2-如何调试-solidity-合约" aria-label="Permalink to &quot;Q2：如何调试 Solidity 合约？&quot;">​</a></h3><ul><li>使用 Remix 的调试器、Hardhat 的 console.log、事件日志</li></ul><h3 id="q3-合约升级后数据如何保持一致" tabindex="-1">Q3：合约升级后数据如何保持一致？ <a class="header-anchor" href="#q3-合约升级后数据如何保持一致" aria-label="Permalink to &quot;Q3：合约升级后数据如何保持一致？&quot;">​</a></h3><ul><li>代理合约存储数据，升级仅替换逻辑合约，数据不变</li></ul><h3 id="q4-如何防止私钥泄露" tabindex="-1">Q4：如何防止私钥泄露？ <a class="header-anchor" href="#q4-如何防止私钥泄露" aria-label="Permalink to &quot;Q4：如何防止私钥泄露？&quot;">​</a></h3><ul><li>使用硬件钱包、冷钱包、助记词离线保存，避免在公网环境暴露私钥</li></ul><h2 id="_19-参考资料与延伸阅读" tabindex="-1">19. 参考资料与延伸阅读 <a class="header-anchor" href="#_19-参考资料与延伸阅读" aria-label="Permalink to &quot;19. 参考资料与延伸阅读&quot;">​</a></h2><ul><li><a href="https://docs.soliditylang.org/" target="_blank" rel="noreferrer">Solidity 官方文档</a></li><li><a href="https://docs.openzeppelin.com/contracts/" target="_blank" rel="noreferrer">OpenZeppelin 合约库</a></li><li><a href="https://hardhat.org/" target="_blank" rel="noreferrer">Hardhat 官方文档</a></li><li><a href="https://book.getfoundry.sh/" target="_blank" rel="noreferrer">Foundry Book</a></li><li><a href="https://consensys.github.io/smart-contract-best-practices/" target="_blank" rel="noreferrer">Ethereum Security Best Practices</a></li><li><a href="https://www.damnvulnerabledefi.xyz/" target="_blank" rel="noreferrer">Damn Vulnerable DeFi</a>（安全攻防练习）</li></ul><h2 id="_20-术语表与缩略语" tabindex="-1">20. 术语表与缩略语 <a class="header-anchor" href="#_20-术语表与缩略语" aria-label="Permalink to &quot;20. 术语表与缩略语&quot;">​</a></h2><table tabindex="0"><thead><tr><th>术语</th><th>解释</th></tr></thead><tbody><tr><td>ABI</td><td>应用二进制接口，前端与合约交互的描述文件</td></tr><tr><td>EOA</td><td>外部拥有账户，普通用户钱包</td></tr><tr><td>DApp</td><td>去中心化应用</td></tr><tr><td>Proxy</td><td>代理合约，用于升级</td></tr><tr><td>Oracle</td><td>预言机，链下数据上链</td></tr><tr><td>Fuzzing</td><td>模糊测试，自动生成测试用例找漏洞</td></tr><tr><td>Reentrancy</td><td>重入攻击，常见安全漏洞</td></tr></tbody></table><hr>`,79)]))}const g=i(e,[["render",t]]);export{o as __pageData,g as default};
