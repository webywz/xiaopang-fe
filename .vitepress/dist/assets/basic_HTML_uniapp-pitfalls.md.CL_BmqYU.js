import{_ as i,c as a,o as n,ag as l}from"./chunks/framework.DPDPlp3K.js";const u=JSON.parse('{"title":"uni-app常见坑与实战经验","description":"总结uni-app项目中遇到的data-*、结构化数据、表单控件等常见坑及解决方案。","frontmatter":{"title":"uni-app常见坑与实战经验","date":"2024-04-28T00:00:00.000Z","description":"总结uni-app项目中遇到的data-*、结构化数据、表单控件等常见坑及解决方案。"},"headers":[],"relativePath":"basic/HTML/uniapp-pitfalls.md","filePath":"basic/HTML/uniapp-pitfalls.md","lastUpdated":1747127846000}'),t={name:"basic/HTML/uniapp-pitfalls.md"};function e(h,s,p,k,r,d){return n(),a("div",null,s[0]||(s[0]=[l(`<h1 id="uni-app常见坑与实战经验" tabindex="-1">uni-app常见坑与实战经验 <a class="header-anchor" href="#uni-app常见坑与实战经验" aria-label="Permalink to &quot;uni-app常见坑与实战经验&quot;">​</a></h1><p>uni-app 支持多端开发（H5/小程序/APP），但在 data-* 属性、结构化数据、表单控件等方面与原生 HTML5 有诸多差异。本文系统总结项目中常见的坑及解决方案。</p><h2 id="一、data-属性相关坑" tabindex="-1">一、data-* 属性相关坑 <a class="header-anchor" href="#一、data-属性相关坑" aria-label="Permalink to &quot;一、data-* 属性相关坑&quot;">​</a></h2><h3 id="_1-dataset-属性名大小写" tabindex="-1">1. dataset 属性名大小写 <a class="header-anchor" href="#_1-dataset-属性名大小写" aria-label="Permalink to &quot;1. dataset 属性名大小写&quot;">​</a></h3><ul><li>data-user-id 会变成 dataset.userId，data-user_id 则变成 dataset.user_id，建议统一用短横线。</li></ul><h3 id="_2-动态绑定-data-属性" tabindex="-1">2. 动态绑定 data 属性 <a class="header-anchor" href="#_2-动态绑定-data-属性" aria-label="Permalink to &quot;2. 动态绑定 data 属性&quot;">​</a></h3><ul><li>必须用 :data-xxx 语法，否则不会响应式更新。</li></ul><h3 id="_3-props-传递对象" tabindex="-1">3. props 传递对象 <a class="header-anchor" href="#_3-props-传递对象" aria-label="Permalink to &quot;3. props 传递对象&quot;">​</a></h3><ul><li>不能直接用 :data-xxx=&quot;obj&quot;，需拆分为单个属性。</li></ul><h3 id="_4-h5端与小程序端-dataset-行为不一致" tabindex="-1">4. H5端与小程序端 dataset 行为不一致 <a class="header-anchor" href="#_4-h5端与小程序端-dataset-行为不一致" aria-label="Permalink to &quot;4. H5端与小程序端 dataset 行为不一致&quot;">​</a></h3><ul><li>H5端可直接用 el.dataset，微信小程序端需用 e.currentTarget.dataset。</li></ul><h4 id="代码示例" tabindex="-1">代码示例 <a class="header-anchor" href="#代码示例" aria-label="Permalink to &quot;代码示例&quot;">​</a></h4><div class="language-vue vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> :data-user-id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;userId&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> :data-role</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;role&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> @click</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;handleClick&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;操作&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> handleClick</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">e</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 小程序端为 e.currentTarget.dataset.userId</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(e.currentTarget.dataset.userId, e.currentTarget.dataset.role);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="二、结构化数据与seo相关坑" tabindex="-1">二、结构化数据与SEO相关坑 <a class="header-anchor" href="#二、结构化数据与seo相关坑" aria-label="Permalink to &quot;二、结构化数据与SEO相关坑&quot;">​</a></h2><h3 id="_1-小程序端结构化数据无效" tabindex="-1">1. 小程序端结构化数据无效 <a class="header-anchor" href="#_1-小程序端结构化数据无效" aria-label="Permalink to &quot;1. 小程序端结构化数据无效&quot;">​</a></h3><ul><li>结构化数据仅对 H5 有效，对小程序无意义。</li></ul><h3 id="_2-动态渲染微数据属性需确保数据已加载" tabindex="-1">2. 动态渲染微数据属性需确保数据已加载 <a class="header-anchor" href="#_2-动态渲染微数据属性需确保数据已加载" aria-label="Permalink to &quot;2. 动态渲染微数据属性需确保数据已加载&quot;">​</a></h3><ul><li>否则 SEO 抓取不到。</li></ul><h3 id="_3-ssr-场景下需在服务端输出结构化数据" tabindex="-1">3. SSR 场景下需在服务端输出结构化数据 <a class="header-anchor" href="#_3-ssr-场景下需在服务端输出结构化数据" aria-label="Permalink to &quot;3. SSR 场景下需在服务端输出结构化数据&quot;">​</a></h3><h4 id="代码示例-1" tabindex="-1">代码示例 <a class="header-anchor" href="#代码示例-1" aria-label="Permalink to &quot;代码示例&quot;">​</a></h4><div class="language-vue vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">article</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> v-if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;isH5&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> itemscope</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> itemtype</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://schema.org/Article&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">h1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> itemprop</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;headline&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;{{ title }}&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">h1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">span</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> itemprop</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;author&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;{{ author }}&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">span</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">article</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> isH5</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> process.env.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">UNI_PLATFORM</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;h5&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="三、表单控件相关坑" tabindex="-1">三、表单控件相关坑 <a class="header-anchor" href="#三、表单控件相关坑" aria-label="Permalink to &quot;三、表单控件相关坑&quot;">​</a></h2><h3 id="_1-pattern、step、autocomplete-等属性在小程序端无效" tabindex="-1">1. pattern、step、autocomplete 等属性在小程序端无效 <a class="header-anchor" href="#_1-pattern、step、autocomplete-等属性在小程序端无效" aria-label="Permalink to &quot;1. pattern、step、autocomplete 等属性在小程序端无效&quot;">​</a></h3><ul><li>需用 JS 手动校验。</li></ul><h3 id="_2-input-事件与原生不一致" tabindex="-1">2. input 事件与原生不一致 <a class="header-anchor" href="#_2-input-事件与原生不一致" aria-label="Permalink to &quot;2. input 事件与原生不一致&quot;">​</a></h3><ul><li>需用 @input/@change 监听。</li></ul><h3 id="_3-表单自动填充、浏览器记忆功能在小程序端无效" tabindex="-1">3. 表单自动填充、浏览器记忆功能在小程序端无效 <a class="header-anchor" href="#_3-表单自动填充、浏览器记忆功能在小程序端无效" aria-label="Permalink to &quot;3. 表单自动填充、浏览器记忆功能在小程序端无效&quot;">​</a></h3><h3 id="_4-部分-type-如-color、range-在小程序端不支持" tabindex="-1">4. 部分 type（如 color、range）在小程序端不支持 <a class="header-anchor" href="#_4-部分-type-如-color、range-在小程序端不支持" aria-label="Permalink to &quot;4. 部分 type（如 color、range）在小程序端不支持&quot;">​</a></h3><h4 id="代码示例-2" tabindex="-1">代码示例 <a class="header-anchor" href="#代码示例-2" aria-label="Permalink to &quot;代码示例&quot;">​</a></h4><div class="language-vue vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">form</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> @submit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;onSubmit&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">input</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> v-model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;email&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;text&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> placeholder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;请输入邮箱&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> form-type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;submit&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;提交&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">form</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { ref } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;vue&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> email</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> onSubmit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">e</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">[\\w.-]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">@</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">[\\w.-]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\\.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\w</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(email.value)) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    uni.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">showToast</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ title: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;邮箱格式错误&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, icon: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;none&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 提交逻辑</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="四、其他常见坑与建议" tabindex="-1">四、其他常见坑与建议 <a class="header-anchor" href="#四、其他常见坑与建议" aria-label="Permalink to &quot;四、其他常见坑与建议&quot;">​</a></h2><ul><li>uni-app 组件库的 data-* 支持有限，建议多用 props 传递数据。</li><li>多端兼容时，建议用 process.env.UNI_PLATFORM 做分端处理。</li><li>遇到兼容性问题，优先查阅<a href="https://uniapp.dcloud.net.cn/" target="_blank" rel="noreferrer">官方文档</a>和社区经验。</li></ul><hr><h2 id="五、生命周期相关坑" tabindex="-1">五、生命周期相关坑 <a class="header-anchor" href="#五、生命周期相关坑" aria-label="Permalink to &quot;五、生命周期相关坑&quot;">​</a></h2><h3 id="_1-生命周期与原生-vue-不完全一致" tabindex="-1">1. 生命周期与原生 Vue 不完全一致 <a class="header-anchor" href="#_1-生命周期与原生-vue-不完全一致" aria-label="Permalink to &quot;1. 生命周期与原生 Vue 不完全一致&quot;">​</a></h3><ul><li>uni-app 支持 onLoad、onShow、onReady、onUnload 等小程序风格生命周期，和 Vue 的 created、mounted 有所不同。</li><li>页面跳转返回时，onShow 会再次触发，但 mounted 不会。</li></ul><h4 id="代码示例-3" tabindex="-1">代码示例 <a class="header-anchor" href="#代码示例-3" aria-label="Permalink to &quot;代码示例&quot;">​</a></h4><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  onLoad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 页面加载</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  onShow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 页面每次显示都会触发</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  mounted</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 只在首次渲染时触发</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>建议</strong>：页面数据刷新逻辑建议放在 onShow。</p><hr><h2 id="六、页面-组件通信相关坑" tabindex="-1">六、页面/组件通信相关坑 <a class="header-anchor" href="#六、页面-组件通信相关坑" aria-label="Permalink to &quot;六、页面/组件通信相关坑&quot;">​</a></h2><h3 id="_1-父子通信" tabindex="-1">1. 父子通信 <a class="header-anchor" href="#_1-父子通信" aria-label="Permalink to &quot;1. 父子通信&quot;">​</a></h3><ul><li>props、$emit 支持，但跨页面通信需用全局状态管理（如 Vuex/pinia）或 uni.$emit/uni.$on。</li></ul><h3 id="_2-跨页面通信" tabindex="-1">2. 跨页面通信 <a class="header-anchor" href="#_2-跨页面通信" aria-label="Permalink to &quot;2. 跨页面通信&quot;">​</a></h3><ul><li>uni-app 推荐用 uni.$emit/uni.$on 或本地存储。</li></ul><h4 id="代码示例-4" tabindex="-1">代码示例 <a class="header-anchor" href="#代码示例-4" aria-label="Permalink to &quot;代码示例&quot;">​</a></h4><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 页面A</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">uni.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$emit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;refreshList&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { id: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 页面B</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">onLoad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  uni.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;refreshList&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 处理刷新</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>注意</strong>：页面销毁时要 uni.$off，防止内存泄漏。</p><hr><h2 id="七、条件编译与多端兼容" tabindex="-1">七、条件编译与多端兼容 <a class="header-anchor" href="#七、条件编译与多端兼容" aria-label="Permalink to &quot;七、条件编译与多端兼容&quot;">​</a></h2><h3 id="_1-条件编译指令" tabindex="-1">1. 条件编译指令 <a class="header-anchor" href="#_1-条件编译指令" aria-label="Permalink to &quot;1. 条件编译指令&quot;">​</a></h3><ul><li>支持 #ifdef H5、#ifdef MP-WEIXIN 等，便于多端差异化处理。</li></ul><h4 id="代码示例-5" tabindex="-1">代码示例 <a class="header-anchor" href="#代码示例-5" aria-label="Permalink to &quot;代码示例&quot;">​</a></h4><div class="language-vue vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">view</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    &lt;!-- #ifdef H5 --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> @click</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;h5Click&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;H5专用&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    &lt;!-- #endif --&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    &lt;!-- #ifdef MP-WEIXIN --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> @click</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;wxClick&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;微信小程序专用&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    &lt;!-- #endif --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">view</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><hr><h2 id="八、性能优化相关坑" tabindex="-1">八、性能优化相关坑 <a class="header-anchor" href="#八、性能优化相关坑" aria-label="Permalink to &quot;八、性能优化相关坑&quot;">​</a></h2><h3 id="_1-列表渲染性能" tabindex="-1">1. 列表渲染性能 <a class="header-anchor" href="#_1-列表渲染性能" aria-label="Permalink to &quot;1. 列表渲染性能&quot;">​</a></h3><ul><li>大量数据建议用虚拟列表（如 uView 的 u-virtual-list），避免 v-for 直接渲染上千条数据。</li></ul><h3 id="_2-图片懒加载" tabindex="-1">2. 图片懒加载 <a class="header-anchor" href="#_2-图片懒加载" aria-label="Permalink to &quot;2. 图片懒加载&quot;">​</a></h3><ul><li>使用 :lazy-load=&quot;true&quot; 或 uni-image 组件，减少首屏压力。</li></ul><h3 id="_3-小程序端-setdata-性能" tabindex="-1">3. 小程序端 setData 性能 <a class="header-anchor" href="#_3-小程序端-setdata-性能" aria-label="Permalink to &quot;3. 小程序端 setData 性能&quot;">​</a></h3><ul><li>数据量大时，避免一次性 setData 过多字段，建议分批更新。</li></ul><hr><h2 id="九、第三方库-原生能力集成" tabindex="-1">九、第三方库/原生能力集成 <a class="header-anchor" href="#九、第三方库-原生能力集成" aria-label="Permalink to &quot;九、第三方库/原生能力集成&quot;">​</a></h2><h3 id="_1-npm-包兼容性" tabindex="-1">1. npm 包兼容性 <a class="header-anchor" href="#_1-npm-包兼容性" aria-label="Permalink to &quot;1. npm 包兼容性&quot;">​</a></h3><ul><li>并非所有 npm 包都能在小程序端用，需查阅官方支持列表。</li></ul><h3 id="_2-原生-js-dom-api-兼容性" tabindex="-1">2. 原生 JS/DOM API 兼容性 <a class="header-anchor" href="#_2-原生-js-dom-api-兼容性" aria-label="Permalink to &quot;2. 原生 JS/DOM API 兼容性&quot;">​</a></h3><ul><li>小程序端不支持 document/window 等原生 DOM API，需用 uni-app 提供的 API。</li></ul><h3 id="_3-原生插件-sdk-集成" tabindex="-1">3. 原生插件/SDK 集成 <a class="header-anchor" href="#_3-原生插件-sdk-集成" aria-label="Permalink to &quot;3. 原生插件/SDK 集成&quot;">​</a></h3><ul><li>集成微信支付、地图等原生能力时，需查阅 uni-app 官方插件市场和平台文档。</li></ul><hr><h2 id="十、ui-组件库相关坑" tabindex="-1">十、UI 组件库相关坑 <a class="header-anchor" href="#十、ui-组件库相关坑" aria-label="Permalink to &quot;十、UI 组件库相关坑&quot;">​</a></h2><h3 id="_1-组件库多端兼容" tabindex="-1">1. 组件库多端兼容 <a class="header-anchor" href="#_1-组件库多端兼容" aria-label="Permalink to &quot;1. 组件库多端兼容&quot;">​</a></h3><ul><li>uView、Vant Weapp、ColorUI 等组件库，部分组件在不同端表现不一致，需多端测试。</li></ul><h3 id="_2-样式隔离" tabindex="-1">2. 样式隔离 <a class="header-anchor" href="#_2-样式隔离" aria-label="Permalink to &quot;2. 样式隔离&quot;">​</a></h3><ul><li>小程序端样式有 scope 隔离，H5 端无，建议用 class 选择器避免样式冲突。</li></ul><hr><h2 id="十一、常见调试与上线问题" tabindex="-1">十一、常见调试与上线问题 <a class="header-anchor" href="#十一、常见调试与上线问题" aria-label="Permalink to &quot;十一、常见调试与上线问题&quot;">​</a></h2><h3 id="_1-h5端与小程序端调试方式不同" tabindex="-1">1. H5端与小程序端调试方式不同 <a class="header-anchor" href="#_1-h5端与小程序端调试方式不同" aria-label="Permalink to &quot;1. H5端与小程序端调试方式不同&quot;">​</a></h3><ul><li>H5 可用浏览器 DevTools，小程序需用微信开发者工具。</li></ul><h3 id="_2-端上真机与模拟器表现差异" tabindex="-1">2. 端上真机与模拟器表现差异 <a class="header-anchor" href="#_2-端上真机与模拟器表现差异" aria-label="Permalink to &quot;2. 端上真机与模拟器表现差异&quot;">​</a></h3><ul><li>真机测试必不可少，尤其是兼容性和性能问题。</li></ul><h3 id="_3-发布上线需多端分别打包" tabindex="-1">3. 发布上线需多端分别打包 <a class="header-anchor" href="#_3-发布上线需多端分别打包" aria-label="Permalink to &quot;3. 发布上线需多端分别打包&quot;">​</a></h3><ul><li>uni-app 支持一键多端打包，但需关注各端配置和审核要求。</li></ul><hr><h2 id="十二、打包与发布常见问题" tabindex="-1">十二、打包与发布常见问题 <a class="header-anchor" href="#十二、打包与发布常见问题" aria-label="Permalink to &quot;十二、打包与发布常见问题&quot;">​</a></h2><h3 id="_1-h5打包后白屏-资源404" tabindex="-1">1. H5打包后白屏/资源404 <a class="header-anchor" href="#_1-h5打包后白屏-资源404" aria-label="Permalink to &quot;1. H5打包后白屏/资源404&quot;">​</a></h3><ul><li>原因：publicPath 配置错误、静态资源未正确拷贝、路由模式与服务器配置不符。</li><li>解决： <ul><li>确认 vite.config.js 或 vue.config.js 的 base/publicPath 设置与部署路径一致。</li><li>H5 路由 history 模式需服务器配置 fallback 到 index.html。</li><li>静态资源建议放 public 目录。</li></ul></li></ul><h3 id="_2-小程序端打包后样式错乱-丢失" tabindex="-1">2. 小程序端打包后样式错乱/丢失 <a class="header-anchor" href="#_2-小程序端打包后样式错乱-丢失" aria-label="Permalink to &quot;2. 小程序端打包后样式错乱/丢失&quot;">​</a></h3><ul><li>原因：组件库样式未引入、分包配置错误、样式隔离冲突。</li><li>解决： <ul><li>检查 main.js 是否全局引入组件库样式。</li><li>分包页面需单独引入依赖样式。</li><li>避免全局样式污染，优先使用 class 局部样式。</li></ul></li></ul><h3 id="_3-小程序端包体积超限" tabindex="-1">3. 小程序端包体积超限 <a class="header-anchor" href="#_3-小程序端包体积超限" aria-label="Permalink to &quot;3. 小程序端包体积超限&quot;">​</a></h3><ul><li>原因：图片/依赖过大、未做分包。</li><li>解决： <ul><li>启用分包，合理拆分业务模块。</li><li>图片资源用云存储或 base64 压缩。</li><li>删除无用依赖和调试代码。</li></ul></li></ul><h3 id="_4-app端打包后功能异常" tabindex="-1">4. APP端打包后功能异常 <a class="header-anchor" href="#_4-app端打包后功能异常" aria-label="Permalink to &quot;4. APP端打包后功能异常&quot;">​</a></h3><ul><li>原因：原生插件未正确集成、权限未声明、平台差异。</li><li>解决： <ul><li>检查 manifest.json 权限声明。</li><li>插件需按官方文档集成并多端测试。</li><li>注意 Android/iOS 差异，部分 API 仅支持单端。</li></ul></li></ul><h3 id="_5-打包后环境变量-接口地址错误" tabindex="-1">5. 打包后环境变量/接口地址错误 <a class="header-anchor" href="#_5-打包后环境变量-接口地址错误" aria-label="Permalink to &quot;5. 打包后环境变量/接口地址错误&quot;">​</a></h3><ul><li>原因：环境变量未正确切换，接口地址写死。</li><li>解决： <ul><li>使用 process.env.NODE_ENV 区分开发/生产环境。</li><li>接口地址用环境变量动态注入。</li></ul></li></ul><h3 id="_6-奇怪问题-打包后页面空白但本地正常" tabindex="-1">6. 奇怪问题：打包后页面空白但本地正常 <a class="header-anchor" href="#_6-奇怪问题-打包后页面空白但本地正常" aria-label="Permalink to &quot;6. 奇怪问题：打包后页面空白但本地正常&quot;">​</a></h3><ul><li>可能原因： <ul><li>依赖包未正确安装或版本冲突。</li><li>代码中存在 window/document 等 H5 专属 API。</li><li>组件/页面未正确注册。</li><li>生产环境接口跨域或 HTTPS 问题。</li></ul></li><li>排查建议： <ul><li>删除 node_modules 重新安装依赖。</li><li>检查控制台和网络请求报错。</li><li>用 console.log 定位渲染流程。</li></ul></li></ul><h3 id="_7-奇怪问题-小程序端真机和开发工具表现不一致" tabindex="-1">7. 奇怪问题：小程序端真机和开发工具表现不一致 <a class="header-anchor" href="#_7-奇怪问题-小程序端真机和开发工具表现不一致" aria-label="Permalink to &quot;7. 奇怪问题：小程序端真机和开发工具表现不一致&quot;">​</a></h3><ul><li>可能原因： <ul><li>微信开发者工具模拟器与真机环境差异。</li><li>部分 API 仅真机支持。</li><li>代码分支/条件编译未覆盖所有端。</li></ul></li><li>解决： <ul><li>必须真机全流程测试。</li><li>用 process.env.UNI_PLATFORM 做分端兼容。</li></ul></li></ul><hr>`,101)]))}const o=i(t,[["render",e]]);export{u as __pageData,o as default};
